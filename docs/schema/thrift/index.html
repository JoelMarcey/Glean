<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Glean Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Glean Blog Atom Feed"><title data-react-helmet="true">Thrift and JSON | Glean</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Thrift and JSON | Glean"><meta data-react-helmet="true" name="description" content="The Glean schema is automatically translated into a set of Thrift type"><meta data-react-helmet="true" property="og:description" content="The Glean schema is automatically translated into a set of Thrift type"><meta data-react-helmet="true" property="og:url" content="https://glean.software/docs/schema/thrift"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://glean.software/docs/schema/thrift"><link rel="stylesheet" href="/styles.b813eb11.css">
<link rel="preload" href="/styles.18f92490.js" as="script">
<link rel="preload" href="/runtime~main.8501fd7b.js" as="script">
<link rel="preload" href="/main.003afee9.js" as="script">
<link rel="preload" href="/1.8bb08397.js" as="script">
<link rel="preload" href="/2.1e10b26e.js" as="script">
<link rel="preload" href="/1be78505.65acd90e.js" as="script">
<link rel="preload" href="/53.317f16e4.js" as="script">
<link rel="preload" href="/935f2afb.5adb77f3.js" as="script">
<link rel="preload" href="/52.9d98051a.js" as="script">
<link rel="preload" href="/7a56567e.15ccba21.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script>
<div style="display: none; text-align: center; background-color: white; color: black;" id="internaldocs-banner"></div><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><strong class="navbar__title">Glean</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/introduction">Documentation</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebookincubator/glean" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><strong class="navbar__title">Glean</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/introduction">Documentation</a></li><li class="menu__list-item"><a class="menu__link" href="/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/facebookincubator/glean" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Quick Start</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/introduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/fb/internal">Glean at Facebook</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/trying">Trying Glean</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/building">Building Glean</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/walkthrough">Walkthrough</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">User Guide</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Schemas</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/schema/basic">Basic Concepts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/schema/types">Built-in Types</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/schema/syntax">Syntax</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/schema/recursion">Recursion</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/schema/changing">Changing a schema</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/schema/workflow">Workflow</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/schema/thrift">Thrift and JSON</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Querying</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/query/intro">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Angle</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/angle/intro">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/angle/guide">Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/angle/efficiency">Query Efficiency</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/angle/advanced">Advanced Query Features</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/angle/debugging">Debugging</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/angle/reference">Reference</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/angle/style">Style Guide</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">APIs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/query/api/haskell">Haskell</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/derived">Derived Predicates</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/databases">Glean Databases</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/write">Writing data to Glean</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/running">Running the Tools</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/shell">Using the Shell</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/server">Running the Glean Server</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cli">The Glean CLI tool</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Thrift and JSON</h1></header><div class="markdown"><p>The Glean schema is automatically translated into a set of Thrift type
definitions by the <code>gen-schema</code> tool (see <a href="/docs/schema/workflow">Workflow</a>).
These Thrift definitions can be used to work with Glean data in your
client, as native data types in whatever language you&#x27;re using, either
for querying data or for writing facts.</p><p>The Thrift types also have a JSON representation, which can be read
and written directly. When you perform queries in the
<a href="/docs/shell">shell</a>, the results are printed as JSON-encoded Thrift;
when you <a href="/docs/write">write data to Glean</a> it can be in the form of
JSON-encoded Thrift.</p><p>The relationship between schema types and Thrift/JSON is given by the following table:</p><table><thead><tr><th>Schema type</th><th>Thrift type</th><th>JSON</th></tr></thead><tbody><tr><td><code>nat</code></td><td><code>Nat</code> (<code>i64</code>)</td><td>123</td></tr><tr><td><code>byte</code></td><td><code>Byte</code> (<code>i8</code>)</td><td>123</td></tr><tr><td><code>string</code></td><td><code>string</code></td><td>&quot;abc&quot;</td></tr><tr><td><code>bool</code></td><td><code>bool</code></td><td><code>true</code> or <code>false</code></td></tr><tr><td><code>[byte]</code></td><td><code>binary</code></td><td>base-64 encoded string <sup>*1</sup></td></tr><tr><td><code>[T]</code></td><td><code>list&lt;T&gt;</code></td><td>[...]</td></tr><tr><td><code>{</code><br>  <code>f₁ : T₁,</code><br>  <code>...,</code><br>  <code>fₙ : Tₙ</code><br><code>}</code></td><td><code>struct Foo {</code><br>  <code>1: T₁ f₁;</code><br>  <code>...</code><br>  <code>n: Tₙ fₙ;</code><br><code>}</code></td><td><code>{</code><br>  <code>&quot;f₁&quot; : q₁,</code><br>  <code>...</code><br>  <code>&quot;fₙ&quot; : qₙ</code><br><code>}</code></td></tr><tr><td><code>{</code><br>  <code>f₁ : T₁ </code><code>|</code><br>  <code>... </code><code>|</code><br>  <code>fₙ : Tₙ</code><br><code>}</code></td><td><code>union Foo {</code><br>  <code>1: T₁ f₁;</code><br>  <code>...</code><br>  <code>n: Tₙ fₙ;</code><br><code>}</code></td><td><code>{ &quot;f&quot; : t }</code><br>for one of the fields <code>f₁</code>..<code>fₙ</code></td></tr><tr><td><code>maybe T</code></td><td>In a record field:<br> <code>optional T f</code></td><td><code>f : t</code><br> if the value is present</td></tr><tr><td><code>enum {</code><br>  <code>L₁</code><code>|</code><br>  <code>...</code><code>|</code><br>  <code>Lₙ</code><br><code>}</code></td><td><code>enum Foo { </code><br>  <code>L₁ = 1,</code><br>  <code>...</code><br>  <code>Lₙ = n</code><br><code>}</code></td><td>the index of the value,<br> e.g. 12</td></tr><tr><td><code>predicate P : K -&gt; V</code></td><td><code>struct P {</code><br>  <code>1: Id id</code><br>  <code>2: optional K key</code><br>  <code>3: optional V value</code><br><code>}</code><br>note<sup>*2</sup></td><td>refer to fact N:<br><code>N</code> or <code>{ &quot;id&quot;: N }</code><br>define a fact:<br><code>{ &quot;id&quot; : N,</code><br>   <code>&quot;key&quot; : t }</code> or<br><code>{ &quot;key&quot;: t }</code> or<br><code>{ &quot;key&quot;: t,</code><br>    <code>&quot;value&quot; : v }</code></td></tr><tr><td><code>type N = T</code></td><td>depending on T: <br><code>struct N { .. }</code><br> <code>union N {...}</code><br> <code>enum N {...}</code><br><code>typedef T N;</code></td><td>same as type T</td></tr></tbody></table><ol><li><p>The Thrift encoding of a binary field in JSON is a base-64-encoded string. However, not all Thrift implementations respect this. At the time of writing, the Python Thrift implementation doesn&#x27;t base-64-encode binary values. For this reason we provide an option in the Glean Thrift API to disable base-64 encoding for binary if your client doesn&#x27;t support it. The Glean Shell also uses this option to make it easier to work with binary.</p></li><li><p>the <code>key</code> is optional - a nested fact may be expanded in place or represented by a reference to the fact ID only. When querying Glean data the query specifies which nested facts should be expanded in the result, and when writing data to Glean using Thrift or JSON, we can optionally specify the value of nested facts inline.</p></li></ol></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/schema/workflow"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Workflow</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/query/intro"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Querying Glean »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Learn</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/introduction">Getting Started</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/fbOpenSource" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebookincubator/glean" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Legal</h4><ul class="footer__items"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy</a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com" target="_blank" rel="noopener noreferrer" class="footerLogoLink_31Aa"><img class="footer__logo" alt="Facebook Open Source Logo" src="/img/oss_logo.png"></a></div><div class="footer__copyright">Copyright © 2021 Facebook, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.18f92490.js"></script>
<script src="/runtime~main.8501fd7b.js"></script>
<script src="/main.003afee9.js"></script>
<script src="/1.8bb08397.js"></script>
<script src="/2.1e10b26e.js"></script>
<script src="/1be78505.65acd90e.js"></script>
<script src="/53.317f16e4.js"></script>
<script src="/935f2afb.5adb77f3.js"></script>
<script src="/52.9d98051a.js"></script>
<script src="/7a56567e.15ccba21.js"></script>
</body>
</html>